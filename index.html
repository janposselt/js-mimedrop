<!DOCTYPE HTML>
<html lang="en">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <title>HTML5 Drag & Drop Mimetype Handler</title>
    <meta name="description" content="HTML5 Drag & Drop Mimetype Handler"/>

    <!-- jquery -->
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js" type="text/javascript"></script>
    <script src="mimedrop.js" type="text/javascript"></script>

    <script type="text/javascript">
        $(function() {

            var insertElement = function(file, element) {
                $('#target').append(
                        $('<div class="dropped"></div>').append(
                            $('<span>Name: </span>').append(file.name),
                            $('<span>Size (Bytes): </span>').append(file.size),
                            $('<span>Mime-Type: </span>').append(file.type),
                            $('<span>Toggle Content</span>').click(function() { element.parent().toggle(); }),
                            $('<div></div>').append(element)
                        )
                );
            }

            $('.mimedrop').mimedrop({
                'handler' : [
                    [
                        'text/html', function(file, index) {
                        var reader = new FileReader();
                            reader.onload = function(e) {
                                var frame = $('<iframe />').bind('load', function() {
                                    var d = frame[0].contentWindow.document;
                                    d.open();
                                    d.write(e.target.result);
                                    d.close();
                                });

                                insertElement(file, frame);
                            };
                            reader.readAsBinaryString(file);
                        }
                    ],
                    [
                        'text/*', function(file, index) {
                            var reader = new FileReader();
                            reader.onload = function(e) {
                                insertElement(file, $('<textarea></textarea>').val(e.target.result));
                            };
                            reader.readAsBinaryString(file);
                        }
                    ],
                    [
                        'image/*', function(file, index) {

                            var reader = new FileReader();
                            reader.onload = function(e) {
                                insertElement(file, $('<img />').attr('src', e.target.result));
                            };
                            reader.readAsDataURL(file);
                        }
                    ],
                    [
                        '*/*', function(file, index) {
                            insertElement(file, $('<p></p>').text('type not registered or unkown'));
                        }
                    ]

                ]
            });
        })
    </script>

    <style>
        * {
            font-family: sans-serif;
        }

        .mimedrop {
            width: 100%;
            height: 100px;
            border: 1px solid silver;
        }

        .dropped span {
            margin-right: 3px;
        }
    </style>

</head>
<body>

<div class="mimedrop"></div>

<div id="target"></div>

</div>
</body>
</html> 
